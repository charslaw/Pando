# Basic Example

The following example shows a potential state tree node that does not follow the guidelines.

```csharp
public record Person(
	string Name,
	string Email,
	DateTime DateOfBirth,
	Gender Gender,
	EyeColor EyeColor,
	short NumberOfFingers
);

public enum Gender { Male, Female, Nonbinary, Unspecified }

public enum EyeColor { Blue, Green, Brown, Hazel, Black, Other }
```

This example creates a contradiction because `Person` can neither be a branch nor a blob. It contains strings, which are
blobs themselves, so it must be a branch, but it also contains raw data, so it must be a blob.

To resolve this contradiction, we can extract the raw data from person into its own blob node for `Person` to contain:

```csharp
public record PersonFixed(
	string Name,
	string Email,
	PersonDetails Details
);

public record PersonDetails(
	DateTime DateOfBirth,
	Gender Gender,
	EyeColor EyeColor,
	short NumberOfFingers
);
```

This is a valid tree because `PersonDetails` is a blob: each of its members can be serialized to a single
value. `PersonValid` is now a pure branch, because it only contains other nodes.

## Memory Layout

Internally, `PersonDetails` would most likely be arranged in the following way in the repository:

```
                    Gender ─┐   ┌─ EyeColor
 ┌───── DateOfBirth ──────┐ ├┐ ┌┤ ┌───┬─ NumberOfFingers
┌──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┐
│00│01│02│03│04│05│06│07│08│09│10│11│12│
└──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┘
```

While `PersonValid` would be arranged thusly:

```
 ┌──── Name Hash ──────┐ ┌──── Email Hash ─────┐ ┌─── Details Hash ────┐
┌──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┐
│00│01│02│03│04│05│06│07│08│09│10│11│12│13│14│15│16│17│18│19│20│21│22│23│
└──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┘
```

The strings will just be arranged as a byte array directly in the repository (UTF8 encoded).

The specific details of how the data is arranged in memory is determined by the Serializer/Deserializer, which is either
provided by you for total customization, or generated by the `Pando.SerializerSourceGenerator`.
